# 1.什么是MVCC？有什么作用？
```
Multiversion Concurrency Control的缩写，该技术让Innodb事务可以进行一致性读事务隔离水平的操作.
就是说当你在查询数据时，这些数据又在被其他事务更新，但你看到的时更新前的数据。该强大的技术
避免了查询等待其他事务更新锁，增加了数据库对并发性的支持。并不是所有的数据库都支持该技术，例如
其他的mysql除了Innodb以外的其他存储引擎不一定支持。
```

# 2.ACID中的I是怎么实现在的？
```
Innodb遵从ACID原则。
A: Atomicity，事务是原子单位的，要么整体提交，要么整体回退。
C: Consistency，在同一时间点，不论数据库在被执行什么操作，对一个查询的返回结果是一致的。
I: Isolation， 事务之间是隔离的，一个事务不能查看另一个事务没有提交的数据。该技术通过锁机制实现。
有经验的开发者，可以修改隔离级别，在确定事务之间不会相互影响的前提下，来提高数据库的性能和并发。
问题来了，怎么确定不会影响事务。
D: Durability, 一个事务一旦提交，事务的结果就会被保存到磁盘，不受任何外界因素干扰，比如断电，系统
崩溃，在Innodb中通过doublewrite buffer来实现持久性。
```

# 3.2PC在数据库中是怎么来实现的？
```
two-phase commit ,是指分布式事务的操作，分布式系统中，当有多个数据库参与一个事务时，所有的数据库要么
都提交事务，要么都回退事务。它通过一个分布式事务协调接口XA实现，允许多个数据库参与一个事务，并遵循
ACID原则。可以配置innodb_support_xa参数来支持。
但是在5.7.10版本中因为会影响性能和造成复制不安全被禁止，在8.0中又被重新放开。
```

# 4.简单讲讲CAP/base/paxos算法。
## 4.1 CAP：
```
分布系统中，Consistency 一致性， Availablity 高可用，Partition tolerance 分区容错性 三者不可兼顾。
nosql数据库的基石。
Consistency： 分布式系统中所有数据备份在同一时刻是否有同样的值。
Availability： 集群中一个节点故障，集群整体可以正常工作。
Partition tolerance： 分区相当于对通信的限制要求。系统不能在限制的时限内，达到数据一致，必须在C和A之间做出选择。
由于当前的网络延迟问题肯定会出现延迟丢包等问题。所以P肯定要实现，也就是说只能选择CP或者CA。
对于WEB2.0系统来说，关系数据库很多主要特性无用武之地。
1. 数据库事务一致性需求
对读写一致性要求低，允许实现最终一致 。
2. 对写实时性和读实时性要求没那么高。比如订阅，允许出现十几秒的延迟。
3. 忌讳多表关联查询
```

## 4.2 base算法	
```
BASE思想的主要实现有
1.按功能划分数据库
2.sharding碎片 

BASE思想主要强调基本的可用性，如果你需要High 可用性，也就是纯粹的高性能，那么就要以一致性或容忍性为牺牲，BASE思想的方案在性能上还是有潜力可挖的。
```
reference
- https://www.jdon.com/37625

## 4.3 paxos算法
```
基于消息传递实现的一种一致性算法。
在分布式数据库系统中，如果各节点初始状态一致，每个节点执行相同的指令序列，那么它们最后可以到达一致的状态。
为保证每个节点执行相同的命令序列，需要在每个指令上加上一致性算法，来保证每个节点看到相同的命令序列。
```

# 5 知识扩充
```
现在NOSQL运动丰富了拓展了BASE思想，可按照具体情况定制特别方案，比如忽视一致性，获得高可用性等等，NOSQL应该有下面两个流派：
1. Key-Value存储，如Amaze Dynamo等，可根据CAP三原则灵活选择不同倾向的数据库产品。
2. 领域模型 + 分布式缓存 + 存储 （Qi4j和NoSql运动），可根据CAP三原则结合自己项目定制灵活的分布式方案，难度高。

这两者共同点：都是关系数据库SQL以外的可选方案，逻辑随着数据分布，任何模型都可以自己持久化，将数据处理和数据存储分离，将读和写分离，存储可以是异步或同步，取决于对一致性的要求程度。

不同点：NOSQL之类的Key-Value存储产品是和关系数据库头碰头的产品BOX，可以适合非Java如PHP RUBY等领域，是一种可以拿来就用的产品，而领域模型 + 分布式缓存 + 存储是一种复杂的架构解决方案，不是产品，但这种方式更灵活，更应该是架构师必须掌握的。
```

